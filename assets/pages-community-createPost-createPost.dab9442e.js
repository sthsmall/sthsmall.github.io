import{M as t}from"./myNav.2499e92c.js";import{m as e}from"./index.0708a0a5.js";import{c as o}from"./code.487141bb.js";import{ay as n,o as s,m as a,g as i,w as l,F as u,r as c,k as r,x as d,j as m,t as p}from"./index-03a9edbf.js";import{_ as k}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-nav-bar.d4137c9f.js";import"./uni-icons.605a44a3.js";import"./uni-app.es.d35c5a99.js";const y=k({components:{MyNav:t},data:()=>({postTitle:"",postContent:"",bankId:0,selectedQuestionBank:null}),methods:{goBack(){this.$router.go(-1)},submitPost(){e({url:"/community/sendNewPost",method:"POST",data:{userId:n.getStorageSync("userId"),title:this.postTitle,content:this.postContent,bankId:this.selectedQuestionBank.id}}).then((t=>{t.data.code===o.POST_OK&&(n.showToast({title:"发帖成功",icon:"success",duration:2e3}),n.switchTab({url:"/pages/community/community"}))})),n.switchTab({url:"/pages/community/community"})},selectQuestionBank(){n.setStorageSync("postTitle",this.postTitle),n.setStorageSync("postContent",this.postContent),n.navigateTo({url:"/pages/community/selectBank/selectBank"})},removeQuestionBank(){this.selectedQuestionBank=null},goBack(){n.setStorageSync("postTitle",this.postTitle),n.setStorageSync("postContent",this.postContent),n.switchTab({url:"/pages/community/community"})},getBankInfo(t){e({url:"/bank/getBankInfo",data:{bankId:t}}).then((t=>{t.data.code===o.GET_OK&&(this.selectedQuestionBank=t.data.data[0])}))}},onShow(){this.postTitle=n.getStorageSync("postTitle"),this.postContent=n.getStorageSync("postContent")},onLoad(t){const e=t.bankId;this.getBankInfo(e)}},[["render",function(t,e,o,n,k,y){const g=c("my-nav"),h=c("van-field"),b=c("van-button"),f=c("van-tag"),B=c("van-form");return s(),a(u,null,[i(g,{title:"发帖",icon:"back",onLeftClick:y.goBack},null,8,["onLeftClick"]),i(B,{onSubmit:y.submitPost},{default:l((()=>[i(h,{modelValue:k.postTitle,"onUpdate:modelValue":e[0]||(e[0]=t=>k.postTitle=t),label:"标题",placeholder:"请输入标题",required:"",clearable:""},null,8,["modelValue"]),i(h,{modelValue:k.postContent,"onUpdate:modelValue":e[1]||(e[1]=t=>k.postContent=t),label:"内容",type:"textarea",placeholder:"写下你的想法...",required:"",rows:"4","show-word-limit":"",maxlength:"200"},null,8,["modelValue"]),r(" 选择题库的按钮 "),d("div",{style:{margin:"16px"}},[i(b,{type:"primary",onClick:y.selectQuestionBank},{default:l((()=>[m("选择题库")])),_:1},8,["onClick"])]),r(" 显示选中的题库 "),k.selectedQuestionBank?(s(),a("div",{key:0,class:"selected-question-bank"},[i(f,{type:"primary",round:"",onClose:y.removeQuestionBank,closeable:""},{default:l((()=>[m(p(k.selectedQuestionBank.name),1)])),_:1},8,["onClose"])])):r("v-if",!0),r(" 提交按钮 "),d("div",{style:{margin:"16px"}},[i(b,{round:"",block:"",onClick:y.submitPost,type:"info","native-type":"submit"},{default:l((()=>[m(" 发布 ")])),_:1},8,["onClick"])])])),_:1},8,["onSubmit"])],64)}],["__scopeId","data-v-90568fbf"]]);export{y as default};
